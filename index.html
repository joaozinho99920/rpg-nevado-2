<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RPG-Nevado-2</title>
<style>
  body {
    background: linear-gradient(to bottom, #0a0a0a, #202040);
    color: white;
    font-family: "Trebuchet MS", sans-serif;
    margin: 0;
    overflow: hidden;
  }
  #game-container {
    display: flex;
    height: 100vh;
    width: 100vw;
  }
  #ui {
    width: 250px;
    background: rgba(0, 0, 0, 0.7);
    padding: 15px;
    overflow-y: auto;
    border-right: 3px solid #333;
  }
  #canvas {
    flex: 1;
    background: #222;
    display: block;
  }
  button {
    width: 100%;
    margin-top: 5px;
    padding: 8px;
    border: none;
    background: #3498db;
    color: white;
    cursor: pointer;
    border-radius: 4px;
  }
  button:hover {
    background: #2980b9;
  }
  h2 {
    text-align: center;
  }
</style>
</head>
<body>
<div id="game-container">
  <div id="ui">
    <h2>RPG-Nevado-2</h2>
    <div id="stats"></div>
    <button onclick="attack()">Atacar</button>
    <button onclick="changeBiome()">Mudar Bioma</button>
    <button onclick="toggleMusic()">ðŸŽµ MÃºsica</button>
  </div>
  <canvas id="canvas" width="800" height="600"></canvas>
</div>

<audio id="music" loop>
  <source src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_c6e7e6f2b5.mp3?filename=epic-battle-music-12507.mp3" type="audio/mpeg">
</audio>

<script>
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");

let player = {
  classe: "Guerreiro",
  hp: 100,
  maxHp: 100,
  atk: 20,
  x: 150,
  y: 400,
  attacking: false
};

let enemy = {
  nome: "Slime",
  hp: 80,
  maxHp: 80,
  atk: 10,
  x: 550,
  y: 400,
  attacking: false
};

let biomas = ["Floresta", "Gelo", "Lava", "Deserto"];
let biomaAtual = 0;

function changeBiome() {
  biomaAtual = (biomaAtual + 1) % biomas.length;
  localStorage.setItem("bioma", biomaAtual);
  gerarInimigo();
}

function gerarInimigo() {
  const tipos = {
    "Floresta": ["Slime", "Goblin", "Lobo"],
    "Gelo": ["Yeti", "Espectro de Gelo", "Urso Polar"],
    "Lava": ["DemÃ´nio", "Golem de Lava", "Salamandra"],
    "Deserto": ["EscorpiÃ£o", "MÃºmia", "Serpente"]
  };
  let nome = tipos[biomas[biomaAtual]][Math.floor(Math.random() * 3)];
  enemy = { nome, hp: 80 + Math.random() * 40, maxHp: 120, atk: 10 + Math.random() * 5, x: 550, y: 400, attacking: false };
}

function drawStickman(x, y, color, attackAnim) {
  ctx.strokeStyle = color;
  ctx.lineWidth = 4;
  ctx.beginPath();
  ctx.arc(x, y - 50, 15, 0, Math.PI * 2);
  ctx.moveTo(x, y - 35);
  ctx.lineTo(x, y + 30);
  ctx.moveTo(x, y + 30);
  ctx.lineTo(x - 20, y + 60);
  ctx.moveTo(x, y + 30);
  ctx.lineTo(x + 20, y + 60);
  ctx.moveTo(x, y - 10);
  ctx.lineTo(x - 25, y + (attackAnim ? -20 : 10));
  ctx.moveTo(x, y - 10);
  ctx.lineTo(x + 25, y + (attackAnim ? -20 : 10));
  ctx.stroke();
}

function drawHpBar(x, y, hp, maxHp, width) {
  ctx.fillStyle = "gray";
  ctx.fillRect(x, y, width, 10);
  ctx.fillStyle = "lime";
  ctx.fillRect(x, y, (hp / maxHp) * width, 10);
  ctx.strokeStyle = "white";
  ctx.strokeRect(x, y, width, 10);
}

function draw() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  ctx.fillStyle = "#333";
  ctx.fillRect(0, 0, canvas.width, canvas.height);

  ctx.fillStyle = "white";
  ctx.font = "20px Arial";
  ctx.fillText("Bioma: " + biomas[biomaAtual], 10, 25);
  ctx.fillText(enemy.nome, 600, 100);
  ctx.fillText("HP: " + Math.floor(enemy.hp), 600, 120);
  drawHpBar(600, 130, enemy.hp, enemy.maxHp, 150);

  drawStickman(player.x, player.y, "cyan", player.attacking);
  drawStickman(enemy.x, enemy.y, "red", enemy.attacking);

  ctx.fillText("HP: " + Math.floor(player.hp), 10, 550);
  drawHpBar(10, 560, player.hp, player.maxHp, 200);

  requestAnimationFrame(draw);
}

function attack() {
  if (player.attacking) return;
  player.attacking = true;
  setTimeout(() => {
    enemy.hp -= player.atk;
    if (enemy.hp <= 0) {
      enemy.hp = 0;
      setTimeout(gerarInimigo, 1000);
    }
    enemyAttack();
    player.attacking = false;
  }, 400);
}

function enemyAttack() {
  if (enemy.attacking || enemy.hp <= 0) return;
  enemy.attacking = true;
  setTimeout(() => {
    player.hp -= enemy.atk;
    if (player.hp <= 0) player.hp = player.maxHp;
    enemy.attacking = false;
  }, 400);
}

function toggleMusic() {
  const music = document.getElementById("music");
  if (music.paused) music.play();
  else music.pause();
}

function updateStats() {
  document.getElementById("stats").innerHTML = `
    <b>Classe:</b> ${player.classe}<br>
    <b>HP:</b> ${Math.floor(player.hp)}/${player.maxHp}<br>
    <b>ATK:</b> ${player.atk}<br>
    <b>Bioma:</b> ${biomas[biomaAtual]}
  `;
}

setInterval(updateStats, 500);
draw();
</script>
</body>
</html>
